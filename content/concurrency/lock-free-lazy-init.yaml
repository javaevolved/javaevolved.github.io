---
id: 55
slug: "lock-free-lazy-init"
title: "Lock-free lazy initialization"
category: "concurrency"
difficulty: "advanced"
jdkVersion: "25"
oldLabel: "Java 8"
modernLabel: "Java 25 (Preview)"
oldApproach: "synchronized + volatile"
modernApproach: "StableValue"
oldCode: |-
  class Config {
      private static volatile Config inst;
      static Config get() {
          if (inst == null) {
              synchronized (Config.class) {
                  if (inst == null)
                      inst = load();
              }
          }
          return inst;
      }
  }
modernCode: |-
  class Config {
      private static final
          StableValue<Config> INST =
              StableValue.of(Config::load);

      static Config get() {
          return INST.get();
      }
  }
summary: "Replace double-checked locking with StableValue for lazy singletons."
explanation: "StableValue encapsulates the lazy initialization pattern with correct\
  \ thread safety. The JVM can optimize the read path after initialization, potentially\
  \ making it faster than volatile reads."
whyModernWins:
- icon: "ðŸ§¹"
  title: "No boilerplate"
  desc: "No volatile, synchronized, or double-null-check."
- icon: "âš¡"
  title: "Faster reads"
  desc: "JVM can constant-fold after initialization."
- icon: "âœ…"
  title: "Provably correct"
  desc: "No subtle ordering bugs â€” the JVM handles it."
support:
  state: "preview"
  description: "Preview in JDK 25 (JEP 502, StableValue). Requires --enable-preview."
prev: "concurrency/concurrent-http-virtual"
next: "io/http-client"
related:
- "concurrency/virtual-threads"
- "concurrency/structured-concurrency"
- "concurrency/scoped-values"
docs:
- title: "StableValue (JEP 502)"
  href: "https://openjdk.org/jeps/502"
- title: "StableValue"
  href: "https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/StableValue.html"
