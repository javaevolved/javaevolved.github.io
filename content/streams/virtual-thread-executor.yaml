---
id: 43
slug: "virtual-thread-executor"
title: "Virtual thread executor"
category: "streams"
difficulty: "intermediate"
jdkVersion: "21"
oldLabel: "Java 8"
modernLabel: "Java 21+"
oldApproach: "Fixed Thread Pool"
modernApproach: "Virtual Thread Executor"
oldCode: |-
  ExecutorService exec =
      Executors.newFixedThreadPool(10);
  try {
      futures = tasks.stream()
          .map(t -> exec.submit(t))
          .toList();
  } finally {
      exec.shutdown();
  }
modernCode: |-
  try (var exec = Executors
          .newVirtualThreadPerTaskExecutor()) {
      var futures = tasks.stream()
          .map(exec::submit)
          .toList();
  }
summary: "Use virtual thread executors for unlimited lightweight concurrency."
explanation: "The virtual thread executor creates a new virtual thread for each task.\
  \ No pool sizing needed ‚Äî virtual threads are cheap enough to create millions of\
  \ them."
whyModernWins:
- icon: "‚ôæÔ∏è"
  title: "No sizing"
  desc: "No pool size to tune ‚Äî create as many threads as needed."
- icon: "‚ö°"
  title: "Lightweight"
  desc: "Virtual threads use KB of memory, not MB."
- icon: "üßπ"
  title: "Auto-closeable"
  desc: "try-with-resources handles shutdown automatically."
support:
  state: "available"
  description: "Widely available since JDK 21 LTS (Sept 2023)"
prev: "streams/stream-gatherers"
next: "streams/optional-ifpresentorelse"
related:
- "streams/stream-gatherers"
- "streams/stream-iterate-predicate"
- "streams/optional-ifpresentorelse"
docs:
- title: "Executors.newVirtualThreadPerTaskExecutor()"
  href: "https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/concurrent/Executors.html#newVirtualThreadPerTaskExecutor()"
- title: "Virtual Threads (JEP 444)"
  href: "https://openjdk.org/jeps/444"
